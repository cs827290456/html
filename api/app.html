<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<script type="text/javascript" src="../ui/helpApi/js/jquery-1.11.0.js"></script>
</head>
<body>
	
	<input type="text" id="sql" value=" SELECT * FROM `log` LIMIT 10" style="width:500px"><br>
	
	<input type="button" value="run" onclick="setRun()">
	
	<hr>
	<input type="button" value="getinfo" onclick="getInfo()">
	<div id='info'>	
	</div> 
	<script type="text/javascript">
	
	var chars = "abcdefghijklmnopqrstuvwxyz";
	chars+= "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
	chars+= "1234567890";
	chars+= "~`!@#$%^&*( )_+,.<>/\\';[]|?-";		

	var my_v =[]
	var my_c = getArr(chars,1,100)

	function getArr(s,len,start){
	    var arr=[];
		var leng = s.length;
		for(var i=0;i<leng;i++){
			var key=s.substring(i,i+len);
			//arr.push(s.substring(i,i+1))
			//arr.push(s.substring(i,i+len))_
			var index = start++;
			my_v[index]=key;
			arr[key] = index;
		}
		//alert(arr)
//		alert(arr.length+"/"+leng )
		return arr;
	}

	function getChar(s){
		var r="";
		var leng = s.length;
		for(var i=0;i<leng;i++){
			var key=s.substring(i,i+1);
			r+=my_c[key];
		}
		return r;
	}

	function getStringByChar(s){
		var r="";
		var leng = s.length;
		for(var i=0;i<leng;i+=3){
			var key=s.substring(i,i+3);
			r+= my_v[key];
		}
		return r;
	}

	
		function setRun(){
			$("#sql").val(" SELECT info,MAX(glod),MIN(glod),MAX(glod)-MIN(glod)FROM LOG WHERE `type` LIKE '%app%' GROUP BY info ");
		}
	
		function getInfo(){ 
			try{
				alert($("#sql").val())
				var url_sql =  getChar($("#sql").val())
				alert(url_sql)
				//http://data.toroot.cn:8289/hxtx/view/common/log.jsp?sql2
				//$.getJSON("http://localhost:8088/hxtx/view/common/log.jsp?sql2="+ url_sql +"&jsoncallback=?",
			 $.getJSON("http://data.toroot.cn:8289/hxtx/view/common/log.jsp?sql="+ url_sql +"&jsoncallback=?",		
					function(json){
						console.log(json)
						//alert(json)
						showInfo(json);
				}); 
			}catch(e){ 
				$("#info").html("---" + e)
			}
		}  
		
		function showInfo(arr){
			if(arr.length <= 0){
				$("#info").html("---- not data")
			}else{
				var html = "<table border=1>"
				for(var i=0;i<arr.length;i++){  
					var item = arr[i];
					if(i ==0){
						html += "<tr>"
						for(k in item){
								html += "<td>"
								html += k;
								html += "</td>"
						}
						html += "</tr>"
					}
					html += "<tr>"
					for(k in item){
						html += "<td>"
						html += item[k];
						html += "</td>"
					}
					html += "</tr>"
				}
				html += "</table>"
				$("#info").html(html)
			}
		}		
		
	</script>
</body>
</html>